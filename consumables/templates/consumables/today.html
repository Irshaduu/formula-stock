{% extends 'consumables/base.html' %}

{% block content %}
<h2 style="
    font-size: 1.1rem;
    border-bottom: 1px solid var(--border-color);
    padding-bottom: 6px;
    margin-bottom: 12px;
">
    Todayâ€™s Consumptions
</h2>

{% if records %}
{% for record in records %}
<div class="item-card" style="
    padding: 8px 10px;
    margin-bottom: 8px;
    align-items: center;
">

    <div class="item-info" style="flex:1; min-width:0;">

        <!-- Staff Name -->
        <div style="
            font-size: 0.7rem;
            color: var(--accent-yellow);
            font-weight: 600;
            line-height: 1;
            margin-bottom: 2px;
        ">
            {{ record.user.first_name|default:record.user.username }}
        </div>

        <!-- Item + Qty -->
        <div style="
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.9rem;
            font-weight: 500;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        ">
            <span style="overflow:hidden; text-overflow:ellipsis;">
                {{ record.item.name }}
            </span>

            <span style="
                font-size: 0.75rem;
                padding: 3px 8px;
                border-radius: 6px;
                background: rgba(0, 0, 0, 0.06);
                color: var(--text-primary);
                font-weight: 600;
                flex-shrink: 0;
                margin-left: auto;
                border: 1px solid rgba(0,0,0,0.05);
            ">
                {{ record.quantity|floatformat }}
            </span>
        </div>

        <!-- Time -->
        <div style="
            font-size: 0.65rem;
            color: var(--text-secondary);
            margin-top: 1px;
        ">
            {{ record.timestamp|time:"h:i A" }}
        </div>
    </div>

    <!-- Undo -->
    {% if request.user == record.user %}
    <a href="{% url 'delete_consumption' record.id %}" class="btn btn-danger" style="
           padding: 4px 6px;
           font-size: 0.65rem;
           margin-left: 6px;
           line-height: 1;
            line-height: 1;
       " onclick="confirmAction(event, 'Restore stock for this item?', this.href)">
        Undo
    </a>
    {% endif %}

</div>
{% endfor %}
{% else %}
<p style="
    text-align: center;
    font-size: 0.8rem;
    color: var(--text-secondary);
    margin-top: 40px;
">
    Nothing taken today yet.
</p>
{% endif %}
{% endblock %}